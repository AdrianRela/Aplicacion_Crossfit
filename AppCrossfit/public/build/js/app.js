let paso=1;const pasoInicial=1,pasoFinal=3;let suscripcion={nombre:"",email:"",telefono:"",tarifa:[]};function iniciarApp(){CambiarContenedor(),mostrarSeccion(),tabs(),botonesPaginador(),paginaSiguiente(),paginaAnterior(),consultaAPI(),quitarAlerta(),botonCompra(),mostrarResumen()}function CambiarContenedor(){try{var e=document.querySelector(".contenedor-app2");null!==e&&(e.classList.remove("contenedor-app2"),e.classList.add("contenedor-app"))}catch(e){console.error("Error al cambiar el contenedor:",e)}}function mostrarSeccion(){const e=document.querySelector(".mostrar");e&&e.classList.remove("mostrar");const o="#paso-"+paso,t=document.querySelector(o);t&&t.classList.add("mostrar");const n=document.querySelector(".actual");n&&n.classList.remove("actual");const r=document.querySelector(`[data-paso="${paso}"]`);r&&r.classList.add("actual")}function tabs(){document.querySelectorAll(".tabs button").forEach(e=>{e.addEventListener("click",(function(e){paso=parseInt(e.target.dataset.paso),mostrarSeccion(),botonesPaginador()}))})}function botonesPaginador(){const e=document.getElementById("anterior"),o=document.getElementById("siguiente");(e||o)&&(1===paso?(e.classList.add("ocultar"),o.classList.remove("ocultar")):3===paso?(e.classList.remove("ocultar"),o.classList.add("ocultar"),mostrarResumen()):(e.classList.remove("ocultar"),o.classList.remove("ocultar"))),mostrarSeccion()}function paginaAnterior(){const e=document.getElementById("anterior");e&&e.addEventListener("click",(function(){paso<=1||(paso--,botonesPaginador())}))}function paginaSiguiente(){const e=document.getElementById("siguiente");e&&e.addEventListener("click",(function(){paso>=3||(paso++,botonesPaginador())}))}async function consultaAPI(){try{const e="/AppCrossfit/api/servicios",o=await fetch(e);mostrarTarifas(await o.json())}catch(e){console.log(e)}}function mostrarTarifas(e){e.forEach(o=>{const{id_bono:t,precio:n,nombre:r}=o,c=document.createElement("p");c.classList.add("nombre-servicio"),c.textContent=r;const a=document.createElement("p");a.classList.add("precio-servicio"),a.textContent=n+" €";const s=document.createElement("div");s.classList.add("servicio"),s.dataset.idServicio=t,s.onclick=function(){seleccionarTarifa(o)},s.append(c),s.append(a),(e=document.querySelector("#servicios"))&&e.append(s)})}function seleccionarTarifa(e){const{id_bono:o,nombre:t,precio:n}=e;suscripcion.tarifa=[o,t,n];document.querySelectorAll(".servicio").forEach((function(e){e.classList.remove("seleccionado")}));document.querySelector(`[data-id-servicio="${o}"]`).classList.add("seleccionado")}function quitarAlerta(){const e=document.querySelectorAll(".alerta");e.length>0&&setTimeout(()=>{e.forEach((function(e){e.remove()}))},5e3)}function envioDatosCompra(){const e=document.querySelector("#formularioPayPal");for(var o in suscripcion)if(suscripcion.hasOwnProperty(o)){var t=document.createElement("input");t.type="hidden",t.name=o,t.value=suscripcion[o],e.appendChild(t)}e.submit()}function botonCompra(){const e=document.getElementById("compra");e&&e.addEventListener("click",(function(){envioDatosCompra()}))}function mostrarResumen(){const e=document.querySelector(".contenido-resumen");if(e&&document.querySelector("#telefono")){const o=document.querySelector("#telefono").value,t=document.querySelector("#nombre").value,n=document.querySelector("#email").value;if(suscripcion.telefono=o,suscripcion.nombre=t,suscripcion.email=n,Object.values(suscripcion).includes("")||0==suscripcion.tarifa.length){const e=document.querySelector(".compra");return e&&(e.style.display="none"),void(Object.values(suscripcion).includes("")&&0!=suscripcion.tarifa.length?mostrarAlerta("Introduzca su teléfono para realizar la compra","error",".contenido-resumen",!1):Object.values(suscripcion).includes("")&&0==suscripcion.tarifa.length?mostrarAlerta("Seleccione tarifa e introduca su teléfono","error",".contenido-resumen",!1):mostrarAlerta("Seleccione una tarifa para realizar la compra","error",".contenido-resumen",!1))}if(!/^[67]\d{8}$/.test(suscripcion.telefono))return void mostrarAlerta("Debe tener 9 digitos y comenzar por 6, 7 o 9","error",".contenido-resumen",!1);const r=document.querySelector(".compra");r&&(r.style.display="flex");const c=document.querySelector(".info-resumen");c&&c.remove(),mostrarAlerta("Datos completados, puede realizar la compra","exito",".contenido-resumen");const a=document.createElement("div");a.className="info-resumen";const s=document.createElement("p");s.innerHTML="<span>Nombre: </span>"+suscripcion.nombre;const i=document.createElement("p");i.innerHTML="<span>Email: </span>"+suscripcion.email;const u=document.createElement("p");u.innerHTML="<span>Teléfono: </span>"+suscripcion.telefono;const l=document.createElement("p");l.innerHTML="<span>Tarifa: </span>"+suscripcion.tarifa[1];const d=document.createElement("p");d.innerHTML=`<span>Precio: </span>${suscripcion.tarifa[2]} €`,a.append(s,i,u,l,d),e.appendChild(a)}}function mostrarAlerta(e,o,t,n=!0){const r=document.querySelector(".alerta");r&&3==paso&&r.remove();const c=document.querySelector(".info-resumen");c&&c.remove();const a=document.createElement("div");a.textContent=e,a.classList.add("alerta"),a.classList.add(o);document.querySelector(t).appendChild(a),n&&setTimeout(()=>{a.remove()},5e3)}document.addEventListener("DOMContentLoaded",(function(){iniciarApp()}));